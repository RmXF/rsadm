# codificación: utf-8
bot_token = "<BOT-TOKEN>"

#LIBRERIAS RESPONDER
de telegrama. ext import Updater #ENVIAR MENSAJES RESPONDIENDO
importar registro #INICIO DE SESION
de telegrama. #COMANDOS de importación ext CommandHandler 

#PREDEFINIDO
updater = Updater(token = bot_token, use_context = True)
dispatcher = actualizador. despachador

#INICIO DE SESION
registro. basicConfig(format='%(asctime)s - %(name)s - %(levelname)s - %(message)s',level=registro. INFORMACIÓN)

#FUNCIONES DE LOS COMANDOS
def start(actualización, contexto):
    imprimir(actualizar. effective_chat. id) #ESCRIBE EL CHAT ID DE LA PERSONA
    
    contexto. bot. send_message(chat_id=actualización. effective_chat. id, texto="HOLA!") #RESPONDE A EL CHAT EN EL QUE LE HABLAN

def personas(actualización, contexto):
    imprimir(actualizar. effective_chat. id) #ESCRIBE EL CHAT ID DE LA PERSONA
    #ALMACENA EL CHAT ID A EL ARCHIVO: personas/personas.txt
    archivo = abierto('personas/personas.txt', 'a')
    archivo. write(str(actualizar. effective_chat. id) +"\n")
    archivo. cerrar()
    
    contexto. bot. send_message(chat_id=actualización. effective_chat. id, text="AHORA ESTÁS EN LA LISTA!!") #RESPONDE A EL CHAT EN EL QUE LE HABLAN
    

start = CommandHandler('start', start) #LLAMA A LA FUNCION start CON EL COMANDO /start
personas = CommandHandler('personas', personas) #LLAMA A LA FUNCION personas CON EL COMANDO /personas
despachador. add_handler(inicio) #ANADE EL COMANDO PARA QUE FUNCIONE
despachador. add_handler(personas) #ANADE EL COMANDO PARA QUE FUNCIONE

actualizador. start_polling() #ENCIENDE EL BOT, PARA PARAR updater.stop()

#USAR SIN COMANDOS, NO HACE FALTA EL USO DE LO DE ARRIBA, SALVO el "bot_token" Y LA LISTA DE CHAT-IDs
#LIBRERIAS SIN RESPONDER
de telegrama import Bot #ENVIAR MENSAJES SIN RESPONDER

#ENVIAR SIN RESPONDER
def enviarSinResponder():
    personasLista = [] #CREA LISTA
    con open('personas/personas.txt', 'r') as archivo: #OBTIENE CHAT IDs OBTENIDOS GRACIAS A /personas
        for personaLinea in archivo:
            persona = personaLinea[:-1]
            personasLista. anexar(persona)
    for i in personasLista: #MANDA UN MENSAJE A CADA UNO DE LAS PERSONAS QUE HAY EN EL ARCHIVO
        bot = Bot(bot_token) #DEFINE "bot" A NUESTRO TOKEN
        
        bot. send_message(chat_id=i,text="ESTO ES UNA PRUEBA!") #MANDA MENSAJE
mientras que verdadero:
    h = entrada("Enviar mensaje")
    enviarSinResponder()
